<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>An Introduction to {ggplot2}</title>
    <meta charset="utf-8" />
    <meta name="author" content="Cédric Scherer" />
    <meta name="date" content="2019-08-29" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/kunoichi.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">

class: inverse, center
background-image: url("img/darklight_RichardStrozynski.jpg")
background-size: contain

&lt;style&gt;
a, a &gt; code {
  color: #e2ac00;
  text-decoration: none;
}

.remark-slide-number {
  position: inherit;
}

.remark-slide-number .progress-bar-container {
  position: absolute;
  bottom: 0;
  height: 4px;
  display: block;
  left: 0;
  right: 0;
}

.remark-slide-number .progress-bar {
  height: 100%;
  background-color: #baa745;
}

.remark-inline-code { 
  color: #ebc500; 
}

.remark-code-line-highlighted { 
  background-color: #ffec89; 
}

.hljs-github .hljs {
  background: #ececec;
}
  
.pull-left {
  float: left;
  width: 50%;
}
.pull-right {
  float: right;
  width: 50%;
}

.logo {
  margin: 0;
  position: absolute;
  top: 30%;
  left: 80%;
  -ms-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);
}
&lt;/style&gt;



&lt;br&gt;&lt;br&gt;
# **An Introduction to `{ggplot2}`**&lt;br&gt;&lt;font size=7 color="#a7a7a7"&gt;A graphics framework for elegant plotting in **`R`**&lt;/font&gt;
&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
### **Cédric Scherer**&lt;br&gt;&lt;font size=5 color="#a7a7a7"&gt;Leibniz Institute for Zoo and Wildlife Research Berlin&lt;/font&gt;&lt;br&gt;&lt;font size=4 color="#ccba56"&gt;&lt;b&gt;IZW Stats Group  |  28th of August 2019&lt;/b&gt;&lt;/font&gt;
&lt;br&gt;&lt;br&gt;&lt;br&gt;
### &lt;p align="right"&gt;&lt;font size=3 color="#767676"&gt;Image by Richard Strozynski&lt;/font&gt;&lt;/p&gt;

---
class: center, middle

&lt;p style="text-align:center;"&gt;&lt;img src="img/logo.png" style="width: 20%"&gt;
&lt;br&gt;&lt;br&gt;

### &lt;font size=7&gt;**`{ggplot2}`** is a system for declaratively creating graphics,&lt;br&gt;based on "The Grammar of Graphics" (Wilkinson, 2005).&lt;/font&gt;
### &lt;font size=6&gt;You provide the data, tell **`{ggplot2}`** how to map variables to aesthetics,&lt;br&gt;what graphical primitives to use, and it takes care of the details.&lt;/font&gt;

&lt;font size="3" color="grey"&gt;&lt;br&gt;&lt;i&gt;ggplot2 package description&lt;/i&gt;&lt;/font&gt;

---
class: middle

# **Advantages of `{ggplot2}`**

* consistent underlying grammar of graphics (Wilkinson, 2005)  

* very flexible, layered plot specification  

* theme system for polishing plot appearance
  
* active and helpful community  
  (e.g. [community.rstudio.com](wwww.community.rstudio.com), [R4DS Learning Community](https://www.rfordatasci.com), [Twitter](https://twitter.com/search?q=%23ggplot2&amp;src=typed_query))

---
class: inverse, center, middle

# **The `{ggplot2}` Showcase**

---
class: inverse

&lt;p style="text-align:center;"&gt;&lt;img src="img/Fig2_disease-data_full_log.png" style="width: 53%"&gt;&lt;br&gt;&lt;font color="lightgrey" size=3&gt;&lt;i&gt;Figure in Scherer et al. 2019 J. Anim. Ecol.&lt;/i&gt;&lt;/font&gt;

---
class: inverse, center, middle

&lt;p style="text-align:center;"&gt;&lt;img src="img/2019-08-18_phone-use.png" style="width: 74%"&gt;&lt;br&gt;&lt;font color="lightgrey" size=3&gt;&lt;i&gt;Contribution to #MakeoverMonday&lt;/i&gt;&lt;/font&gt;

---
class: inverse, center, middle

&lt;p style="text-align:center;"&gt;&lt;img src="img/2019_18_BirdCollisions.png" style="width: 68%"&gt;&lt;br&gt;

&lt;p style="text-align:center;"&gt;&lt;img src="img/2019_19_StudentTeacher.png" style="width: 68%"&gt;&lt;br&gt;&lt;font color="lightgrey" size=3&gt;&lt;i&gt;Contribution to #TidyTuesday&lt;/i&gt;&lt;/font&gt;

---
class: inverse, center, middle

&lt;p style="text-align:center;"&gt;&lt;img src="img/bbc-gallery.png" style="width: 120%"&gt;&lt;br&gt;&lt;font color="lightgrey" size=3&gt;&lt;i&gt;Collection of BBC Graphics&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color="grey" size=2&gt;&lt;i&gt;(adapted from bbc.github.io/rcookbook)&lt;/i&gt;&lt;/font&gt;

---
class: inverse, center, middle

# **The Setup**

---
## **The package**

&lt;font size=5&gt;**`{ggplot2}`** is a **data visualization package** for the statistical programming language **`R`**&lt;br&gt;
created by Hadley Wickham in 2005.


```r
install.packages("ggplot2")
library(ggplot2)
```

--
&lt;br&gt;&lt;font size=4&gt;**`{ggplot2}`** is part of the [**`{tidyverse}`**](https://blog.rstudio.org/2016/09/15/tidyverse-1-0-0/), a set of packages that work in harmony to manipulate and explore data.


```r
install.packages("tidyverse")
library(tidyverse)
```

&lt;font size=4&gt;**`{tidyverse}`** contains **`{ggplot2}`**, **`{dplyr}`**, **`{tidyr}`**, **`{readr}`**, **`{purrr}`**, **`{tibble}`** and some more packages.

&lt;p style="text-align:right;"&gt;&lt;img src="img/tidyverse.png" style="width: 50%"&gt;&lt;font color="grey" size=2&gt;&lt;i&gt;Source: www.dicook.org/files/rstudio/#3&lt;/i&gt;&lt;/font&gt;&lt;/p&gt;

---
## **The data**

We use data from the *National Morbidity and Mortality Air Pollution Study* (NMMAPS),&lt;br&gt;filtered for the city of Chicago and the timespan January 1997 to December 2000.


```r
chic &lt;- readr::read_csv("https://raw.githubusercontent.com/Z3tt/R-Tutorials/master/ggplot2/chicago-nmmaps.csv")
chic$year &lt;- factor(chic$year, levels = as.character(1997:2000))
tibble::glimpse(chic)
```

```
## Observations: 1,461
## Variables: 10
## $ city     &lt;chr&gt; "chic", "chic", "chic", "chic", "chic", "chic", "chic...
## $ date     &lt;date&gt; 1997-01-01, 1997-01-02, 1997-01-03, 1997-01-04, 1997...
## $ death    &lt;dbl&gt; 137, 123, 127, 146, 102, 127, 116, 118, 148, 121, 110...
## $ temp     &lt;dbl&gt; 36.0, 45.0, 40.0, 51.5, 27.0, 17.0, 16.0, 19.0, 26.0,...
## $ dewpoint &lt;dbl&gt; 37.500, 47.250, 38.000, 45.500, 11.250, 5.750, 7.000,...
## $ pm10     &lt;dbl&gt; 13.052268, 41.948600, 27.041751, 25.072573, 15.343121...
## $ o3       &lt;dbl&gt; 5.659256, 5.525417, 6.288548, 7.537758, 20.760798, 14...
## $ time     &lt;dbl&gt; 3654, 3655, 3656, 3657, 3658, 3659, 3660, 3661, 3662,...
## $ season   &lt;fct&gt; Winter, Winter, Winter, Winter, Winter, Winter, Winte...
## $ year     &lt;fct&gt; 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997,...
```

---
class: inverse, center, middle

# **The Structure of `{ggplot2}`**&lt;br&gt;&lt;font size=6 color="#a7a7a7"&gt;"The Grammar of Graphics"&lt;/font&gt;

---
## **The Structure of `{ggplot2}`**

&lt;br&gt;

1. **Data** &lt;font color="grey"&gt; →  The raw data that you want to visualise&lt;/font&gt;

2. **Layers `geom_` and `stat_`** &lt;font color="grey"&gt; →  The geometric shapes and statistical summaries representing the data&lt;/font&gt; 

3. **Aesthetics `aes()`** &lt;font color="grey"&gt; →  Aesthetic mappings of the geometric and statistical objects&lt;/font&gt;  

4. **Scales `scale_`** &lt;font color="grey"&gt; →  Maps between the data and the aesthetic dimensions&lt;/font&gt;

5. **Coordinate system `coord_`** &lt;font color="grey"&gt; →  Maps data into the plane of the data rectangle&lt;/font&gt;
  
6. **Facets `facet_`** &lt;font color="grey"&gt; →  The arrangement of the data into a grid of plots&lt;/font&gt;
  
7. **Visual themes `theme() and theme_`** &lt;font color="grey"&gt; →  The overall visual defaults of a plot&lt;/font&gt;

---
class: inverse, center, middle

# **1. Data&lt;br&gt;&lt;font size=6&gt;`ggplot(data, aes(x, y))`&lt;/font&gt;**

---



### **1. Data: `ggplot()`**

We need to specify data and the two variables we want to plot as **`aes`**tethics of the **`ggplot()`** call:

.pull-left[

```r
*ggplot(data = chic,
*      mapping =
*        aes(
*         x = date,
*         y = temp
*       )
*     )
```
There is only an empty panel because&lt;br&gt;**`{ggplot2}` doesn't know *how* it should plot the data**.
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-data-vars-1.png)&lt;!-- --&gt;
]

---
### **1. Data: `ggplot()`**

We need to specify data and the two variables we want to plot as **`aes`**tethics of the **`ggplot()`** call:

.pull-left[
Since almost every **`ggplot()`** takes the same arguments (**`data, mapping = aes(x, y)`**),&lt;br&gt;we can also write:


```r
*ggplot(chic, aes(date, temp))
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-data-vars2-1.png)&lt;!-- --&gt;
]

---

### **1. Data: `ggplot()`**

We need to specify data and the two variables we want to plot as **`aes`**tethics of the **`ggplot()`** call:

.pull-left[
Since almost every **`ggplot()`** takes the same arguments (**`data, mapping = aes(x, y)`**),&lt;br&gt;we can also write:


```r
ggplot(chic, aes(date, temp))
```

... or add the **`aes`**thetics outside the **`ggplot`** function:


```r
ggplot(chic) +
* aes(date, temp)
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-data-vars4-1.png)&lt;!-- --&gt;
]

---
class: inverse, center, middle

# **2. Layers&lt;br&gt;&lt;font size=6 color = "grey"&gt;`geom_*()` and `stat_*()`&lt;/font&gt;**

---
### **2. Layers: `geom_*()` and `stat_*()`**

By adding one or multiple layers we can tell **`{ggplot2}`** *how* to represent the data.&lt;br&gt;
There are lots of build-in geometrics elements (**`geoms`**) and statistical transformations (**`stats`**):

&lt;p style="text-align:left;"&gt;&lt;img src="img/ggplot-layers.png" style="width: 57%"&gt;&lt;font color="grey" size=2&gt;&lt;i&gt;Adapted from https://ggplot2.tidyverse.org/reference/&lt;/i&gt;&lt;/font&gt;&lt;/p&gt;

&lt;font size=3&gt;... and several more in extension packages, e.g. **`ggforce`**, **`ggalt`**, **`ggridges`**, **`ggrepel`**, **`ggcorrplot`**, **`ggraph`** and **`ggdendro`**.

---
### **2. Layers — Geometries: `geom_point()`**

We can tell **`{ggplot2}`** to represent the data for example as a **scatterplot**:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
* geom_point()
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-geom-point-1.png)&lt;!-- --&gt;
]

---
### **2. Layers — Geometries: `geom_line()`**

... or a **line plot**:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
* geom_line()
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-geom-line-1.png)&lt;!-- --&gt;
]

---
### **2. Layers — Geometries: `geom_area()`**

... or an **area plot**:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
* geom_area()
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-geom-area-1.png)&lt;!-- --&gt;
]

---
### **2. Layers — Geometries: `geom_boxplot()`**

... or a **box and whiskers plot**:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
* geom_boxplot()
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-geom-box-1.png)&lt;!-- --&gt;
]

---
### **2. Layers — Geometries: `geom_boxplot()`**

... or a **box and whiskers plot**:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
* geom_boxplot()
```

&lt;br&gt;&lt;font size=6&gt;&lt;b&gt;What's going on here?!&lt;/b&gt;&lt;/font&gt;
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-geom-box2-1.png)&lt;!-- --&gt;
]

---
### **2. Layers — Geometries: `geom_boxplot()`**

We need to specify the  variable as **categorial** (**`year`**), not as **continuous** (**`date`**):

.pull-left[

```r
*ggplot(chic, aes(year, temp)) +
    geom_boxplot() 
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-geom-box-fct-1.png)&lt;!-- --&gt;
]

---
### **2. Layers — Geometries: `geom_rug()`**

Other layers can be added to an existing plot - a rug representation for example:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point() +
* geom_rug(sides = "r")
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-geom-rug-1.png)&lt;!-- --&gt;
]

---
### **2. Layers — Statistical transformations: `stat_summary()`**

A handful of layers with attention to the statistical transformation rather than the visual appearance:

.pull-left[

```r
ggplot(chic, aes(year, temp)) +
  geom_boxplot() +
* stat_summary(
*   fun.y = mean,
*   geom = "point"
*  )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-scale-stats-sum-1.png)&lt;!-- --&gt;
]

---
### **2. Layers — Statistical transformations: `stat_function()`**

**`stat_function()`** makes it easy to add a function to a plot, either continuous or discrete:

.pull-left[

```r
ggplot(tibble(x = c(-8, 8)), aes(x)) +
* stat_function(fun = dnorm) +
* stat_function(
*   fun = dcauchy,
*   geom = "point",
*   n = 75
* )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-stats-function-1.png)&lt;!-- --&gt;
]

---
### **2. Layers — Statistical transformations: `stat_ecdf()`**

You can also easily plot the empirical cumulative distribution function (ECDF) of a variable:

.pull-left[

```r
ggplot(chic, aes(temp)) +
* stat_ecdf(geom = "step")
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-stats-ecdf-1.png)&lt;!-- --&gt;
]

---
### **2. Layers — Statistical transformations: `stat_smooth()`**

You can directly add smoothed conditional means:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point() +
* stat_smooth()
```

By default this adds a **LOESS** (locally weighted scatterplot smoothing, **`method = "loess"`**) or a &lt;br&gt;**GAM** (generalized additive model, **`method = "gam"`**) depending on the number of data points&lt;br&gt;(GAM in case of ≥ 1000 observations).
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-stats-smooth2-1.png)&lt;!-- --&gt;
]

---
### **2. Layers — Statistical transformations: `stat_smooth()`**

You can specify the fitting method and the formula:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point() +
* stat_smooth(
*   method = "gam",
*   formula = y ~ s(x, k = 100),
*   se = F
* )
```

Other methods such as **`method = "lm"`** for linear regressions and **`method = "glm"`** for generalized linear models are available as well.
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-stats-smooth-gam-1.png)&lt;!-- --&gt;
]

---
class: inverse, center, middle

# **3. Aesthetics&lt;br&gt;&lt;font size=6&gt;`aes()`&lt;/font&gt;**

---
### **3. Aesthetics: `aes()`**

Aesthetics of the geometric and statistical objects, such as 

* **position** via **`x`**, **`y`**, **`xmin`**, **`xmax`**, **`ymin`**, **`ymax`**, ...

--

* **colors** via **`color`** and **`fill`**

* **transparency** via **`alpha`**

--

* **sizes** via **`size`** and **`width`**

* **shapes** via **`shape`**  and **`linetype`**

--

&lt;br&gt; In general, everything which maps to the data needs to be wrapped in **`aes()`**&lt;br&gt;while static arguments are placed outside the **`aes()`**.

--

e.g.&lt;br&gt;
**`geom_point(aes(color = season))`** to color points based on the variable **`season`**&lt;br&gt;
**`geom_point(color = "grey")`** to color all points in the same color

---
### **3. Aesthetics: `aes(color/fill/alpha/size/shape)`**

This way, we can  enlarge all points and add some transparency:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point(
*   size = 4,
*   alpha = 0.2
  )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-aes-size-alpha-1.png)&lt;!-- --&gt;
]

---
### **3. Aesthetics: `aes(color/fill/alpha/size/shape)`**

... and change the color and the shape based on **`season`** and **`year`**:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point(
*   aes(
*     color = season,
*     shape = year
*   ),
    size = 4,
    alpha = 0.2
  )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-aes-col-shape-1.png)&lt;!-- --&gt;
]

---
### **3. Aesthetics: `aes(color/fill/alpha/size/shape)`**

Alternatively, all **`aes`**thetics can be grouped together (and are then applied to all **`geoms`** and **`stats`**):

.pull-left[

```r
ggplot(
  chic, 
  aes(date, 
      temp,
*     color = season,
*     shape = year)
  ) +
  geom_point(
    size = 4,
    alpha = 0.2
  )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-aes-col-shape2-1.png)&lt;!-- --&gt;
]

---
### **3. Aesthetics: `aes(group)`**

You can create subsets of the data by specifying a grouping variable via **`group`**:

.pull-left[

```r
ggplot(chic, aes(temp)) +
  stat_ecdf(
*   aes(group = year),
    geom = "step"
  )
```

&lt;br&gt;However, for most applications you can simply specify the grouping using visual aesthetics&lt;br&gt;(**`color`**, **`fill`**, **`alpha`**, **`shape`**, **`linetype`**).
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-aes-group-1.png)&lt;!-- --&gt;
]

---
### **3. Aesthetics: `aes(group)`**

You can create subsets of the data by specifying a grouping variable via **`group`**:

.pull-left[

```r
ggplot(chic, aes(temp)) +
  stat_ecdf(
*   aes(color = year),
    geom = "step"
  )
```

&lt;br&gt;However, for most applications you can simply specify the grouping using visual aesthetics&lt;br&gt;(**`color`**, **`fill`**, **`alpha`**, **`shape`**, **`linetype`**).
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-aes-group-col-1.png)&lt;!-- --&gt;
]

---
class: inverse, center, middle

# **4. Scales&lt;br&gt;&lt;font size=6&gt;`scale_*()`&lt;/font&gt;**

---
### **4. Scales: `scale_`**

One can use **`scale_*()`** to change properties of all the **aesthetic dimensions mapped to the data**.

&lt;br&gt;Consequently, there are **`scale_*()`** functions for all aesthetics such as:

* **position** via **`scale_x_*()`** and **`scale_y_*()`**

* **colors** via **`scale_color_*()`** and **`scale_fill_*()`**

* **transparency** via **`scale_alpha_*()`**

* **sizes** via **`scale_size_*()`**

* **shapes** via **`scale_shape_*()`**  and **`scale_linetype_*()`**

---
### **4. Scales: `scale_`**

One can use **`scale_*()`** to change properties of all the **aesthetic dimensions mapped to the data**.

&lt;br&gt;Consequently, there are **`scale_*()`** functions for all aesthetics such as:

* **position** via **`scale_x_*()`** and **`scale_y_*()`**

* **colors** via **`scale_color_*()`** and **`scale_fill_*()`**

* **transparency** via **`scale_alpha_*()`**

* **sizes** via **`scale_size_*()`**

* **shapes** via **`scale_shape_*()`**  and **`scale_linetype_*()`**

... with extensions (**`*`**) such as
* **`continuous()`**, **`discrete()`**, **`reverse()`**, **`log10()`**, **`squrt()`**, **`date()`**, **`time()`** for axes
* **`continuous()`**, **`discrete()`**, **`manual()`**, **`gradient()`**, **`hue()`**, **`brewer()`** for colors and fills
* **`continuous()`**, **`discrete()`**, **`manual()`**, **`ordinal()`**, **`identity()`**, **`date()`** for transparencies
* **`continuous()`**, **`discrete()`**, **`manual()`**, **`ordinal()`**, **`identity()`**, **`area()`**, **`date()`** for sizes
* **`continuous()`**, **`discrete()`**, **`manual()`**, **`ordinal()`**, **`identity()`** for shapes and linetypes

---
### **4. Scales: `scale_x_*()` and `scale_y_*()`**

For example, to change the titles of the axes...

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point(aes(color = season)) +
* scale_x_date(
*   name = NULL
* ) +
* scale_y_continuous(
*   name = "Temperature (°F)"
* )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-scale-axis-1.png)&lt;!-- --&gt;
]

---
### **4. Scales: `scale_x_*()` and `scale_y_*()`**

... and their properties such as the range, scaling, labels, and axis breaks:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point(aes(color = season)) +
  scale_x_date(
    name = NULL, 
*   limits = c(
*     as.Date("1997-01-01"),
*     as.Date("1999-12-31")
*   )
  ) + 
* scale_y_log10(
    name = "Temperature (°F)",
*   breaks = c(1, 10, 100),
*   labels = scales::scientific
  )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-scale-axis2-1.png)&lt;!-- --&gt;
]

---
### **4. Scales: `scale_x_*()` and `scale_y_*()`**

With **`breaks`** and **`labels`** it's also possible to alter the labels without changing the data:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point(aes(color = season)) +
  scale_x_date(
    name = NULL, 
    limits = c(
      as.Date("1997-01-01"),
      as.Date("1999-12-31")
    )
  ) + 
  scale_y_continuous(
*   name = "How I feel...",
*   breaks = c(0, 30, 60, 90),
*   labels = c(
*     '"Brrr, too cold!"',
*     '"Still freezing."',
*     '"Okay."',
*     '"Uff, too hot!"'
*   )
  )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-scale-labels-1.png)&lt;!-- --&gt;
]

---
### **4. Scales: `scale_x_*()` and `scale_y_*()`**

Some people are annoyed by the extra spacing around the data but we can remove that:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point(aes(color = season)) +
  scale_x_date(
    name = NULL,
*   expand = c(0, 0)
  ) + 
  scale_y_continuous(
    name = "Temperature (°F)",
*   expand = c(0, 0)
  )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-scale-axis-expand-1.png)&lt;!-- --&gt;
]

---
### **4. Scales: `scale_color_*()` and `scale_fill_*()`**

Similarly, we can change properties of the other aesthetics. for example get rid of the default colors:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point(aes(color = season)) +
* scale_color_manual(
*   values = c(
*     "firebrick",
*     "dodgerblue",
*     "darkorchid",
*     "goldenrod"
*   )
* )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-scale-color-1.png)&lt;!-- --&gt;
]

---
### **4. Scales: `scale_color_*()` and `scale_fill_*()`**

... and change the title of the legend:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point(aes(color = season)) +
  scale_color_manual( 
    values = c( 
      "firebrick",
      "dodgerblue",
      "darkorchid",
      "goldenrod"
    ),
*   name = "Pretty\ncolored\nsesons:"
  ) 
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-scale-color-legend-1.png)&lt;!-- --&gt;
]

---
### **4. Scales: `scale_color_*()` and `scale_fill_*()`**

... or remove the legend for a specific aesthetic:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point(aes(color = season)) +
  scale_color_manual( 
    values = c( 
      "firebrick",
      "dodgerblue",
      "darkorchid",
      "goldenrod"
    ),
*   guide = FALSE
  ) 
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-scale-color-legend-off-1.png)&lt;!-- --&gt;
]

---
### **4. Scales: `scale_shape_*()`**

... or remove the legend for a **specific** aesthetic:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point(aes(color = season,
*                shape = year)) +
  scale_color_manual( 
    values = c( 
      "firebrick",
      "dodgerblue",
      "darkorchid",
      "goldenrod"
    ),
*   guide = FALSE
  ) +
* scale_shape_discrete(
*   solid = FALSE,
*   name = "Year"
* )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-scale-color-legend-off+shape-1.png)&lt;!-- --&gt;
]

---
### **4. Scales: `scale_color_*()` and `scale_fill_*()`**

One can of course also use preset color palettes:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point(aes(color = season)) +
* scale_color_brewer(
*   palette = "Set2",
    guide = FALSE
  ) 
```

Several packages offer predefined palettes, e.g.:
* **`{viridis}`** for color-blind safe palettes
* **`{rcartocolor}`** for map color schemes
* **`{LaCroixColoR}`** for vibrant summery colors
* **`{ggthemes}`** for colors of popular software and publishers

Check the [collection by Emil Hvitfeldt](https://github.com/EmilHvitfeldt/r-color-palettes) for a list of color palettes available in **`R`**.
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-scale-color-brewer2-1.png)&lt;!-- --&gt;
]

---
### **4. Scales: `scale_color_*()` and `scale_fill_*()`** — Color Palettes

![](intro-ggplot_files/figure-html/plots-viridis-1.png)&lt;!-- --&gt;

---
class: inverse, center, middle

# **5. Coordinate System&lt;br&gt;&lt;font size=6&gt;`coord_*()`&lt;/font&gt;**

---
### **5. Coordinate System: `coord_*()`**

Coordinate systems combine the two position aesthetics (usually **`x`** and **`y`**) to produce a 2d position on the plot.
&lt;br&gt;&lt;br&gt;

--

The meaning of the position aesthetics depends on the coordinate system used: 

* Linear coordinate systems that preserve the shape of geoms:&lt;br&gt;&lt;br&gt;
    + **`coord_cartesian()`**: the default with two fixed perpendicular oriented axes
    + **`coord_flip()`**: a Cartesian coordinate system with flipped axes
    + **`coord_fixed()`**: a Cartesian coordinate system with a fixed aspect ratio

--

* Non-linear coordinate systems that likely change the shapes:&lt;br&gt;&lt;br&gt;
    + **`coord_map()`**: map projections
    + **`coord_polar()`**: a polar coordinate system
    + **`coord_trans()`**: arbitrary transformations to x and y positions

---
### **5. Coordinate System: `coord_cartesian()`**

**`coord_*()`** functions allow you to zoom in a plot:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_line() +
* coord_cartesian(
*   ylim = c(50, 70)
* )
```

Note that this does prevent a removal of the data points outside the plot area!&lt;br&gt;
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-coord-zoom-1.png)&lt;!-- --&gt;
]

---
### **5. Coordinate System: `coord_cartesian()`**

In case you want to remove those data points, use **`scale_y_continuous(limits = c(min, max))`**:

.pull-left[

```r
ggplot(chic, aes(year, temp)) +
  geom_boxplot()  +
* coord_cartesian(
*   ylim = c(50, 70)
* )
```

![](intro-ggplot_files/figure-html/structure-coord-zoom-box-1.png)&lt;!-- --&gt;
]

.pull-right[

```r
ggplot(chic, aes(year, temp)) +
  geom_boxplot()  +
* scale_y_continuous(
*   limits = c(50, 70)
* )
```

![](intro-ggplot_files/figure-html/structure-coord-lim-box-1.png)&lt;!-- --&gt;
]

---
### **5. Coordinate System: `coord_cartesian()`**

`coord_*()` is also used to *prevent clipping* of points and correct alignment of axis ticks:

.pull-left[


```r
ggplot(chic, aes(date, temp)) +
  geom_point() +
* scale_x_date(
*   expand = c(0, 0)
* ) +
* coord_cartesian(ylim = c(0, 80))

ggplot(chic, aes(date, temp)) +
  geom_point() +
  scale_x_date(
    expand = c(0, 0)
  ) + 
  coord_cartesian(
    ylim = c(0, 80), 
*   clip = "off"
  )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-scale-axis-clip-1.png)&lt;!-- --&gt;![](intro-ggplot_files/figure-html/plot-structure-scale-axis-clip-2.png)&lt;!-- --&gt;
]

---
### **5. Coordinate System: `coord_flip()`**

**`coord_flip()`** allows you to flip a Cartesian coordinate system:

.pull-left[

```r
ggplot(chic, aes(season, temp)) +
  geom_col() +
* coord_flip()
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-coord-flip-1.png)&lt;!-- --&gt;
]

---
### **5. Coordinate System: `coord_polar()`**

You can easily transform a rectangular coordinate system into a polar one:

.pull-left[

```r
ggplot(chic, aes(season, temp)) +
  stat_summary(fun.y = mean,
              geom = "bar")
```

![](intro-ggplot_files/figure-html/structure-coord-polar-before-1.png)&lt;!-- --&gt;
]

.pull-right[

```r
ggplot(chic, aes(season, temp)) +
  stat_summary(fun.y = mean,
              geom = "bar") +
* coord_polar()
```

![](intro-ggplot_files/figure-html/structure-coord-polar-1.png)&lt;!-- --&gt;
]

---
### **5. Coordinate System: `coord_trans()`**

 The difference between transforming the scales and transforming the coordinate system is that coordinate transformation occurs **after** the statistics:

.pull-left[

```r
ggplot(chic, aes(o3, temp)) +
  geom_point() +
* coord_trans(x = "log2")
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-coord-trans-1.png)&lt;!-- --&gt;
]

---
### **5. Coordinate System: `coord_map()`**

Maps often come as polygons and can be plotted via **`geom_polygon()`**:

.pull-left[

```r
(g_world &lt;- 
  ggplot(map_data("world"),
         aes(long, lat, 
             group = group)) +
*   geom_polygon(
*     fill = "tan",
*     color = "grey20"
*   )
)
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-coord-map-noproj-1.png)&lt;!-- --&gt;
]

---
### **5. Coordinate System: `coord_map()`**

Since maps are displaying spherical data, we must project the data via **`coord_map()`**:

.pull-left[

```r
g_world +
* coord_map(xlim = c(-180,180))
```

![](intro-ggplot_files/figure-html/structure-coord-map-proj1-1.png)&lt;!-- --&gt;
]

.pull-right[

```r
g_world +
* coord_map("ortho")
```

![](intro-ggplot_files/figure-html/plot-structure-coord-map-proj2-1.png)&lt;!-- --&gt;
]

---
class: inverse, center, middle

# **6. Facets&lt;br&gt;&lt;font size=6&gt;`facet_*()`&lt;/font&gt;**

---
### **6. Facets: `facet_*()`**

Facetting generates small multiples each showing a different subset of the data:

&lt;p style="text-align:center;"&gt;&lt;img src="img/position-facets.png" style="width: 75%"&gt;&lt;/p&gt;
&lt;p style="text-align:right;"&gt;&lt;font color="grey" size=2&gt;&lt;i&gt;Adapted from "ggplot2: Elegant Graphics for Data Analysis" by Hadley Wickham&lt;/i&gt;&lt;/font&gt;&lt;/p&gt;

---
### **6. Facets: `facet_wrap()`**

**`facet_wrap()`** splits the data into small multiples based on *one grouping variable*:

.pull-left[

```r
ggplot(chic, aes(temp, o3)) +
  geom_point(aes(color = year)) +
* facet_wrap(~ season)
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-facet-wrap-1.png)&lt;!-- --&gt;
]

---
### **6. Facets: `facet_wrap()`**

**`facet_wrap()`** splits the data into small multiples based on *one grouping variable*:

.pull-left[

```r
ggplot(chic, aes(temp, o3)) +
  geom_point(aes(color = year)) +
  facet_wrap(~ season, 
*            scales = "free")
```

It is possible to change the axes range to scale free for each subset (for only one axis to scale free use **`"free_x"`** or **`"free_y"`**.
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-facet-wrap2-1.png)&lt;!-- --&gt;
]

---
### **6. Facets: `facet_grid()`**

**`facet_grid()`** spans a grid of each combination of *two grouping variables*:

.pull-left[

```r
ggplot(chic, aes(temp, o3)) +
  geom_point(aes(color = year)) +
* facet_grid(season ~ year)
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-facet-grid-1.png)&lt;!-- --&gt;
]

---
class: inverse, center, middle

# **7. Visual Themes&lt;br&gt;&lt;font size=6 color = "grey"&gt;`theme()` and `theme_*()`&lt;/font&gt;**

---
### **7. Visual Themes: `theme()` and `theme_*()`** 

* Themes control the display of all non-data elements of the plot&lt;br&gt;
  
  + titles
  + labels
  + fonts
  + background
  + gridlines
  + legends
  + base size!

--

* Themes can be modified for each plot by calling **`theme()`** and **`element_`** functions

--

* Themes can be used to give plots a consistent customized look by defining a custom theme using **`theme_update()`** or **`theme_set()`**&lt;br&gt;

---
### **7. Visual Themes: `theme()`** 

To modify the theme of a plot use **`theme()`** in combination with **`element_*()`**:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point() +
* theme(
*   axis.text = element_text(
*     size = 15,
*     face = "bold",
*     color = "red"
*   ),
*   panel.grid.major.x = element_line(
*     linetype = "dotted",
*     color = "black"
*   ),
*   plot.background = element_rect(
*     fill = "dodgerblue",
*     color = "goldenrod"
*   )
* )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-theme-manual-1.png)&lt;!-- --&gt;
]

---
### **7. Visual Themes: `theme()`** 

**`element_blank()`** can be used to remove certain theme elements:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point() +
* theme(
*   axis.title.x = element_blank(),
*   panel.grid.major.y = element_blank(),
*   panel.grid.minor = element_blank()
* )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-theme-blank-1.png)&lt;!-- --&gt;
]

---
### **7. Visual Themes: `theme_*()`** 

Use a built-in theme of **`{ggplot2}`**:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point() +
* theme_gray()
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-theme-builtin-1.png)&lt;!-- --&gt;
]

---
### **7. Visual Themes: `theme_*()`** 

Use a built-in theme of **`{ggplot2}`**:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point() +
* theme_minimal()
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-theme-builtin2-1.png)&lt;!-- --&gt;
]

---
### **7. Visual Themes: `theme_*()`** 

Using the argument **`base_size()`** you can change the size of the text:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point() +
* theme_bw(base_size = 40)
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-theme-base-size-1.png)&lt;!-- --&gt;
]

---
### **7. Visual Themes: `theme_*()`** 

There are also extension packages such as **`{ggthemes}`**, **`{hrbrthemes}`**  and **`{tvthemes}`**:



&lt;p style="text-align:center;"&gt;&lt;img src="img/theme_panel.png" style="width: 92%"&gt;&lt;/p&gt;

---
### **7. Visual Themes: `theme_set()` and `theme_update()`** 

**`theme_set()`** and **`theme_update()`** override settings completely or partly:

.pull-left[

```r
(g &lt;- ggplot(chic, aes(date, temp)) +
  geom_point())
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-theme-override1-1.png)&lt;!-- --&gt;
]

---
### **7. Visual Themes: `theme_set()` and `theme_update()`** 

**`theme_set()`** and **`theme_update()`** override settings completely or partly:

.pull-left[

```r
(g &lt;- ggplot(chic, aes(date, temp)) +
  geom_point())

*old &lt;- theme_set(theme_grey())
*g 
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-theme-override2-1.png)&lt;!-- --&gt;
]

---
### **7. Visual Themes: `theme_set()` and `theme_update()`** 

**`theme_set()`** and **`theme_update()`** override settings completely or partly:

.pull-left[

```r
(g &lt;- ggplot(chic, aes(date, temp)) +
  geom_point())

old &lt;- theme_set(theme_grey())
g

*theme_update(
* panel.background = element_rect(
*   fill = "tan",
*   color = "black"
* )
*) 
*g 
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-theme-override3-1.png)&lt;!-- --&gt;
]

---
### **7. Visual Themes: `theme_set()` and `theme_update()`** 

**`theme_set()`** and **`theme_update()`** override settings completely or partly:

.pull-left[

```r
(g &lt;- ggplot(chic, aes(date, temp)) +
  geom_point())

old &lt;- theme_set(theme_grey())
g

theme_update(
  panel.background = element_rect(
    fill = "tan",
    color = "black"
  )
)
g

*theme_set(old)
*g 
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-structure-theme-override4-1.png)&lt;!-- --&gt;
]

---
class: inverse, center, middle

# **Some more?**

---
&lt;font size=2&gt;

* **Free Online Books:**

  + "ggplot2: Elegant Graphics for Data Analysis" by Hadley Wickham  →  [ggplot2-book.org](https://ggplot2-book.org/)
  + "R for Data Science" by Hadley Wickham  →  [r4ds.had.co.nz](https://r4ds.had.co.nz/)
  + "Data Visualization: A Practical Introduction" by Kieran Healy  →  [socviz.co](https://socviz.co/)
  + "Fundamentals of Data Visualization" by Claus Wilke  →  [serialmentor.com/dataviz](https://serialmentor.com/dataviz/)

+ **Galleries:**

  + R Graph Gallery  →  [r-graph-gallery.com](https://www.r-graph-gallery.com/)
  + ggplot2 Extension Gallery  →  [ggplot2-exts.org/gallery](http://www.ggplot2-exts.org/gallery/)
  + Color Palettes in R  →  [github.com/EmilHvitfeldt/r-color-palettes](https://github.com/EmilHvitfeldt/r-color-palettes/)
  + &amp;#35;TidyTuesday Collection  →  [tidytuesday.rocks](http://tidytuesday.rocks/)

* **Get Help:**

  + RStudio Community  →  [community.rstudio.com](wwww.community.rstudio.com)
  + R4DS Learning Community  →  [rfordatasci.com](https://www.rfordatasci.com)
  + &amp;#35;TidyTuesday Community  →  [#TidyTuesday on Twitter](https://twitter.com/hashtag/tidytuesday?lang=en)

* **Useful packages:**

  + **`{ggtext}`** — rich-text rendering  →  [github.com/clauswilke/ggtext](https://github.com/clauswilke/ggtext)
  + **`{ggforce}`** — several interesting add-on features   →  [ggforce.data-imaginist.com](https://ggforce.data-imaginist.com/)
  + **`{ggridges}`** — geoms for joy plots  →  [github.com/clauswilke/ggridges](https://github.com/clauswilke/ggridges)
  + **`{ggrepel}`** — prevent overlapping text labels  →  [github.com/slowkow/ggrepel](https://github.com/slowkow/ggrepel)
  + **`{gganimate}`** — create animations  →  [gganimate.com](https://gganimate.com/)
  + **`{ggplotly}`** — create interactive plots  →  [plot.ly/ggplot2](https://plot.ly/ggplot2/)
  + **`{ggraph}`** — networks, graphs &amp; trees  →  [github.com/thomasp85/ggraph](https://github.com/thomasp85/ggraph)
  + **`{ggalt}`** — alternative coords, geoms, stats &amp; scales  →  [github.com/hrbrmstr/ggalt](https://github.com/hrbrmstr/ggalt)
  + **`{ggpubr}`** — publication-ready plot in one line  →  [github.com/kassambara/ggpubr](https://github.com/kassambara/ggpubr)
  + **`{ggmaps}`** — access to Google &amp; Stamen maps  →  [github.com/dkahle/ggmap](https://github.com/dkahle/ggmap)
  + **`{ggthemes}`** —  additional themes, sclaes &amp; geoms →  [github.com/jrnold/ggthemes](https://github.com/jrnold/ggthemes)
  + **`{hrbrthemes}`** — typography-centric themes  →  [github.com/hrbrmstr/hrbrthemes](https://github.com/hrbrmstr/hrbrthemes)
  + **`{lemon}`** — axis &amp; legend add-ons  →  [github.com/stefanedwards/lemon](https://github.com/stefanedwards/lemon)
  + **`{cowplot}`** — plot arrangements, themes &amp; annotations  →  [wilkelab.org/cowplot](https://wilkelab.org/cowplot/articles/introduction.html)
  + **`{patchwork}`** — combine ggplots  →  [github.com/thomasp85/patchwork](https://github.com/thomasp85/patchwork)
  + **`{showtext}`** — use custom fonts  →  [github.com/yixuan/showtext](https://github.com/yixuan/showtext)
  + **`{rayshader}`** — hillshaded maps in 2D &amp; 3D  →  [github.com/tylermorganwall/rayshader](https://github.com/tylermorganwall/rayshader)

.logo[
&lt;img src="./img/logo_ressources.png" width="1328" /&gt;
]

---
class: inverse, center, middle

# **You want even more?**

---
class: inverse, center, middle

# **Working with Text**

---
### **Working with Text: Title, Subtitle, Caption, and Tag**

To quickly add a title, use **`ggtitle()`**:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point() +
* ggtitle("Temperatures in Chicago")
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-text-title-1.png)&lt;!-- --&gt;
]

---
### **Working with Text: Title, Subtitle, Caption, and Tag**

**`{ggplot2}`** has a built-in structure for title, subtitle, caption and tags via **`labs()`**:

.pull-left[

```r
(g &lt;- ggplot(chic, aes(date, temp)) +
  geom_point() +
* labs(
*   x = "Year",
*   y = "Temperature (°F)",
*   title = "Temperatures in Chicago",
*   subtitle = "Seasonal pattern of daily temperatures\nfrom 1997 to 2001",
*   caption = "Data: NMMAPS",
*   tag = "(a)"
* )
)
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-text-labs-1.png)&lt;!-- --&gt;
]

---
### **Working with Text: Title, Subtitle, Caption, and Tag**

**`{ggplot2}`** has a built-in structure for title, subtitle, caption and tags:

.pull-left[

```r
g +
* theme(
*   plot.title = element_text(
*     size = 20,
*     face = "bold",
*     hjust = 1,
*     margin = margin(15, 0, 15, 0)
*   ),
*   plot.caption = element_text(
*     face = "italic"
*   ),
*   plot.tag.position = c(0.15, 0.75)
* )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-text-labs-mod-1.png)&lt;!-- --&gt;
]

---
### **Working with Text: `annotate("text")`**

**`annotate()`** allows to add text inside the plot area:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point() +
* annotate(
*   "text",
*   x = as.Date("1998-07-01"),
*   y = 10,
*   label = "The Summer\nof 1998",
*   size = 3,
*   fontface = "bold",
*   color = "firebrick"
* )
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-text-annotate-1.png)&lt;!-- --&gt;
]

---
### **Working with Text: `annotate("text")`**

The **`annotate()`** function comes from ggplot2 and is designed to use a so-called **grob** as input:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
  geom_point() +
  annotate(
    "text",
    x = as.Date("1998-07-01"),
    y = 10,
    label = "The Summer\nof 1998",
    size = 3,
    fontface = "bold",
    color = "firebrick"
  ) +
* facet_wrap(~year, scales = "free_x")
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-text-annotate-facet-1.png)&lt;!-- --&gt;
]

---
### **Working with Text: `annotation_custom(grob)`**

**`annotation_custom()`** allows to add text by relative positions which solves the problem:

.pull-left[

```r
*text &lt;- grid::grobTree(
* grid::textGrob(
*   "Summertime!",
*   x = 0.5, y = 0.1, hjust = 0.5,
*   gp = grid::gpar(
*     fontsize = 12,
*     fontface = "bold",
*     col = "firebrick"
*   )
* )
*) 

ggplot(chic, aes(date, temp)) +
  geom_point() +
* annotation_custom(text) +
  facet_wrap(~ year, scales = "free_x")
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-text-annotate-custom-1.png)&lt;!-- --&gt;
]

---
### **Working with Text: `element_markdown()` via `{ggtext}`**

With the new **`{ggtext}`** package, it is possible to use Markdown and basic HTML within strings:

.pull-left[

```r
*library(ggtext)

ggplot(chic, aes(date, temp)) +
  geom_point(aes(color = season)) +
  scale_color_manual(
    name = NULL,
    values = c("#0072B2", "#009E73", "#FF8423", "#B22222"),
*   labels = c(
*     "&lt;b style='color:#0072B2'&gt;Spring:&lt;br&gt;&lt;/b&gt;&lt;i&gt;Apr to Jun&lt;br&gt;&lt;/i&gt;",
*     "&lt;b style='color:#009E73'&gt;Summer:&lt;/b&gt;&lt;br&gt;&lt;i&gt;Jul to Sep&lt;br&gt;&lt;/i&gt;",
*     "&lt;b style='color:#FF8423'&gt;Autumn:&lt;/b&gt;&lt;br&gt;&lt;i&gt;Oct to Dec&lt;br&gt;&lt;/i&gt;",
*     "&lt;b style='color:#B22222'&gt;Winter:&lt;/b&gt;&lt;br&gt;&lt;i&gt;Jan to Mar&lt;br&gt;&lt;/i&gt;"
*   )
  ) +
* theme(legend.text = element_markdown())
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-text-ggtext-1.png)&lt;!-- --&gt;
]

---
class: inverse, center, middle

# **Working with Images**

---
### **Working with Images: `annotation_custom(grob)`**

The **`annotation_custom()`** function comes with ggplot2 and is designed to use a so-called **grob** as input:

.pull-left[

```r
*img &lt;- png::readPNG("./img/logo.png")
*logo &lt;- grid::rasterGrob(img, interpolate = T)

ggplot(chic, aes(date, temp)) +
* annotation_custom(
*   logo,
*   xmin = as.Date("1997-06-01"),
*   xmax = as.Date("2000-06-01"),
*   ymin = 0,
*   ymax = 80
* ) +
  geom_point(alpha = 0.2)
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-text-annotate-img-1.png)&lt;!-- --&gt;
]

---
### **Working with Images: `element_markdown()` via `{ggtext}`**

It also has basic support for the html &lt;img&gt; tag:

.pull-left[

```r
ggplot(iris, aes(Species, Sepal.Width)) +
  geom_boxplot() +
* scale_x_discrete(
*   name = NULL,
*   labels = c(
*     setosa = "*I. setosa*&lt;br&gt;&lt;img src='https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/Iris_setosa.JPG/180px-Iris_setosa.JPG' width='100' /&gt;",
*     virginica = "*I. virginica*&lt;br&gt;&lt;img src='https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/Iris_virginica_-_NRCS.jpg/320px-Iris_virginica_-_NRCS.jpg' width='100' /&gt;",
*     versicolor = "*I. versicolor*&lt;br&gt;&lt;img src='https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/20140427Iris_versicolor1.jpg/320px-20140427Iris_versicolor1.jpg' width='100' /&gt;"
*   )
* ) +
* theme(axis.text.x = element_markdown())
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-text-ggtext-img-1.png)&lt;!-- --&gt;
]

---
class: inverse, center, middle

# **Working with Geometric Forms**

---
### **Working with Geometric Forms: `annotate("rect")`**

Let's add some background indicating the years:

.pull-left[

```r
ggplot(chic, aes(date, temp)) +
* annotate(
*   "rect",
*   xmin = as.Date("1997-01-01"),
*   xmax = as.Date("1997-12-31"),
*   ymin = -Inf, ymax = Inf,
*   color = NA, alpha = 0.2
* ) +
*   annotate(
*   "rect",
*   xmin = as.Date("1999-01-01"),
*   xmax = as.Date("1999-12-31"),
*   ymin = -Inf, ymax = Inf,
*   color = NA, alpha = 0.2
* ) +
  geom_point()
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-forms-annotate-rect-1.png)&lt;!-- --&gt;
]

---
### **Working with Geometric Forms: `annotate("rect")` or `geom_rect()`?**

If you plot many elements, use **`geom_rect()`**:

.pull-left[

```r
*rect &lt;- tibble(
* xmin = as.Date(c("1997-01-01",
*                  "1999-01-01")),
* xmax = as.Date(c("1997-12-31",
*                  "1999-12-31")),
* ymin = rep(-Inf, 2),
* ymax = rep(Inf, 2)
*) 

ggplot(chic) +
* geom_rect(
*   data = rect,
*   aes(xmin = xmin, xmax = xmax,
*       ymin = ymin, ymax = ymax),
*   color = NA,
*   alpha = 0.2
* ) +
  geom_point(aes(date, temp))
```
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-forms-geom-rect-1.png)&lt;!-- --&gt;
]

---
### **Working with Geometric Forms: `geom_vline()`**

We could also indicate new years by a vertical line:

.pull-left[

```r
*lines &lt;- tibble(
* xintercept = seq(
*   as.Date("1997-01-01"),
*   as.Date("2001-01-01"),
*   length.out = 5)
*) 

ggplot(chic, aes(date, temp)) +
* geom_vline(
*   data = lines,
*   aes(xintercept = xintercept),
*   color = "grey30") +
  geom_point()
```

There are also **`geom_abline()`** and **`geom_hline()`**.
]

.pull-right[
![](intro-ggplot_files/figure-html/plot-forms-vline-1.png)&lt;!-- --&gt;
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "<div class=\"progress-bar-container\">   <div class=\"progress-bar\" style=\"width: calc(%current% / %total% * 100%);\">   </div> </div> ",
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
